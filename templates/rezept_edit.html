{% extends "base.html" %}

{% block content %}
<div style="max-width: 900px; margin: 0 auto; padding: 20px;">
    <h1>‚úèÔ∏è Rezept bearbeiten</h1>
    <p style="color: #666;">{{ rezept.name }}</p>
    
    <form action="{{ url_for('edit_rezept', rezept_id=rezept.id) }}" method="POST" style="margin-top: 30px;">
        <!-- Rezeptname -->
        <div class="form-group">
            <label for="name">Rezeptname *</label>
            <input type="text" id="name" name="name" class="form-control" value="{{ rezept.name }}" required />
        </div>

        <!-- Beschreibung -->
        <div class="form-group">
            <label for="description">Beschreibung *</label>
            <textarea id="description" name="description" class="form-control" rows="2" required>{{ rezept.description }}</textarea>
        </div>

        <hr>

        <!-- Zutaten -->
        <div class="form-group">
            <label>Zutaten</label>
            <div id="zutaten-container">
                {% for zutat in zutaten %}
                <div class="zutat-row" style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <input type="hidden" name="zutat_id[]" value="{{ zutat.id }}">
                    <input type="text" name="zutat_name[]" class="form-control" placeholder="Zutat" value="{{ zutat.name }}" style="flex: 2;">
                    <input type="number" name="zutat_number[]" class="form-control" placeholder="Menge" step="0.01" value="{{ zutat.number if zutat.number else '' }}" style="flex: 1;">
                    <input type="text" name="zutat_einheit[]" class="form-control" placeholder="Einheit" value="{{ zutat.einheit if zutat.einheit else '' }}" style="flex: 1;">
                    <button type="button" class="btn btn-sm btn-danger" onclick="this.parentElement.remove()" style="flex: 0;">√ó</button>
                </div>
                {% endfor %}
                
                <!-- Leere Zeile f√ºr neue Zutaten -->
                <div class="zutat-row" style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <input type="hidden" name="zutat_id[]" value="">
                    <input type="text" name="zutat_name[]" class="form-control" placeholder="Zutat" style="flex: 2;">
                    <input type="number" name="zutat_number[]" class="form-control" placeholder="Menge" step="0.01" style="flex: 1;">
                    <input type="text" name="zutat_einheit[]" class="form-control" placeholder="Einheit" style="flex: 1;">
                    <button type="button" class="btn btn-sm btn-danger" onclick="this.parentElement.remove()" style="flex: 0;">√ó</button>
                </div>
            </div>
            <button type="button" class="btn btn-sm btn-default" onclick="addZutat()">
                + Weitere Zutat hinzuf√ºgen
            </button>
        </div>

        <hr>

        <!-- Buttons -->
        <div style="margin-top: 30px;">
            <button type="submit" class="btn btn-primary btn-lg">√Ñnderungen speichern</button>
            <a href="{{ url_for('rezept_detail', rezept_id=rezept.id) }}" class="btn btn-default btn-lg">Abbrechen</a>
        </div>
    </form>
</div>

<script>
// Zutat hinzuf√ºgen
function addZutat() {
  const container = document.getElementById('zutaten-container');
  const newRow = document.createElement('div');
  newRow.className = 'zutat-row';
  newRow.style.cssText = 'display: flex; gap: 10px; margin-bottom: 10px;';
  newRow.innerHTML = `
    <input type="hidden" name="zutat_id[]" value="">
    <input type="text" name="zutat_name[]" class="form-control" placeholder="Zutat" style="flex: 2;">
    <input type="number" name="zutat_number[]" class="form-control" placeholder="Menge" step="0.01" style="flex: 1;">
    <input type="text" name="zutat_einheit[]" class="form-control" placeholder="Einheit" style="flex: 1;">
    <button type="button" class="btn btn-sm btn-danger" onclick="this.parentElement.remove()" style="flex: 0;">√ó</button>
  `;
  container.appendChild(newRow);
}

 <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 20px;">
        <div style="display: flex; align-items: center; gap: 10px;">
            <h1 style="margin: 0;">{{ rezept.name }}</h1>
            {% if rezept.user_id is none %}
                <span style="background: #2196F3; color: white; padding: 5px 12px; border-radius: 6px; font-size: 14px;">Allgemeines Rezept</span>
            {% else %}
                <span style="background: #4caf50; color: white; padding: 5px 12px; border-radius: 6px; font-size: 14px;">Mein Rezept</span>
            {% endif %}
        </div>
        
        {% if rezept.user_id is not none and rezept.user_id == current_user_id %}
        <div style="display: flex; gap: 10px;">
            <a href="{{ url_for('edit_rezept', rezept_id=rezept.id) }}" class="btn btn-warning">
                ‚úèÔ∏è Rezept bearbeiten
            </a>
            <form action="{{ url_for('delete_rezept', rezept_id=rezept.id) }}" method="POST" onsubmit="return confirm('M√∂chtest du dieses Rezept wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.');" style="margin: 0;">
                <button type="submit" class="btn btn-danger">
                    üóëÔ∏è Rezept l√∂schen
                </button>
            </form>
        </div>

</script>
{% endblock %}
