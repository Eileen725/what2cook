{% extends "base.html" %}

{% block content %}
<h2 style="margin-bottom: 20px;">üç≥ Meine Rezepte</h2>

<!-- Suchfeld -->
<div style="margin-bottom: 20px;">
  <input type="text" 
         id="search-input" 
         class="form-control" 
         placeholder="üîç Rezepte durchsuchen..." 
         style="font-size: 16px; padding: 12px;">
</div>

<!-- Rezeptliste -->
<ul class="rezept-list" id="rezept-list">
  {% for rezept in rezepte %}
  <li class="rezept-item" data-name="{{ rezept.name|lower }}" data-description="{{ rezept.description|lower }}">
    <form action="/complete" method="POST" class="rezept-complete-form">
      <input type="hidden" name="id" value="{{ rezept.id }}">
      <input type="checkbox" class="rezept-checkbox" id="rezept-{{ rezept.id }}" name="complete" value="1"
        onchange="this.form.submit()">
    </form>

    <a href="{{ url_for('rezept_detail', rezept_id=rezept.id) }}" class="rezept-content">
      {{ rezept.name }}
      <span class="rezept-description">{{ rezept.description }}</span>
    </a>
  </li>
  {% else %}
  <div id="no-recipes">Keine Rezepte vorhanden... üç≥</div>
  {% endfor %}
</ul>

<div id="no-results" style="display: none; text-align: center; padding: 30px; color: #999;">
  Keine Rezepte gefunden üîç
</div>

<!-- Neues Rezept hinzuf√ºgen -->
<div class="rezept-form" style="margin-top: 40px;">
  <h3>Neues Rezept hinzuf√ºgen</h3>
  <form action="." method="POST">
    <div class="form-group">
      <label for="name">Rezeptname</label>
      <input type="text" id="name" name="name" class="form-control" placeholder="Neues Rezept eingeben‚Ä¶" required />
    </div>

    <div class="form-group">
      <label for="description">Beschreibung</label>
      <input id="description" name="description" type="text" class="form-control" required>
      <p class="help-block">Kurze Beschreibung des Rezepts.</p>
    </div>

    <button type="submit" class="btn btn-primary">Hinzuf√ºgen</button>
  </form>
</div>

<script>
// Live-Suche f√ºr Rezepte
document.getElementById('search-input').addEventListener('input', function(e) {
  const searchTerm = e.target.value.toLowerCase().trim();
  const rezeptItems = document.querySelectorAll('.rezept-item');
  const noResults = document.getElementById('no-results');
  let visibleCount = 0;

  rezeptItems.forEach(function(item) {
    const name = item.getAttribute('data-name');
    const description = item.getAttribute('data-description');
    
    // Pr√ºfe ob Suchbegriff in Name oder Beschreibung vorkommt
    if (name.includes(searchTerm) || description.includes(searchTerm)) {
      item.style.display = 'block';
      visibleCount++;
    } else {
      item.style.display = 'none';
    }
  });

  // Zeige "Keine Ergebnisse" wenn nichts gefunden wurde
  if (visibleCount === 0 && searchTerm !== '') {
    noResults.style.display = 'block';
  } else {
    noResults.style.display = 'none';
  }
});
</script>
{% endblock %}